<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Geolocation API 실시간 위치 추적</title>
    <link th:href="@{/css/location-style.css}" rel="stylesheet">
</head>
<body>
<header>
    <div class="navbar">
        <div class="logo">
            <h1>Movie Review Site</h1>
        </div>
        <nav>
            <ul class="menu-right">
                <li><a href="/home">홈</a></li>
                <li><a href="/mypage">마이페이지</a></li>
                <li><a href="/location">위치 테스트</a></li>
                <li><a href="/reviews" class="review-button">Write a Review</a></li>
                <li><a href="/logout" class="logout-button">Logout</a></li>
            </ul>
        </nav>
    </div>
</header>

<main>
    <h1>Geolocation API로 실시간 위치 추적하기</h1>
    <button onclick="startTracking()">실시간 추적 시작</button>
    <button onclick="stopTracking()">추적 중지</button>
    <p id="status">위치를 찾지 못했습니다</p>
</main>

<script>
    let watchId;

    function startTracking() {
      const status = document.getElementById("status");

      // Geolocation API 지원 여부 확인
      if ("geolocation" in navigator) {
        watchId = navigator.geolocation.watchPosition(
          (position) => {
            const { latitude, longitude, accuracy } = position.coords;
            status.textContent = `위도: ${latitude}, 경도: ${longitude}, 정확도: ${accuracy}미터`;
          },
          (error) => {
            status.textContent = `위치 정보를 가져올 수 없습니다: ${error.message}`;
          },
          {
            enableHighAccuracy: true, // 정확도 우선 모드
            timeout: 10000,           // 10초 이내에 응답 없으면 에러 발생
            maximumAge: 0             // 항상 최신 위치 정보 수집
          }
        );
      } else {
        status.textContent = "브라우저가 위치 서비스를 지원하지 않습니다.";
      }
    }

    function stopTracking() {
      navigator.geolocation.clearWatch(watchId);
      document.getElementById("status").textContent = "위치 추적이 중지되었습니다.";
    }
</script>
</body>
</html>